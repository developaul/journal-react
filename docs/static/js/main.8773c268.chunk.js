(this["webpackJsonpjournal-app"]=this["webpackJsonpjournal-app"]||[]).push([[0],{156:function(e,t,n){},157:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(2),c=n(33),s=n.n(c),o=n(8),i=n(16),u=n(22),l=n(10),d=n(37),j=n.n(d),p=n(36),b=n(5),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(r.useState)(e),n=Object(i.a)(t,2),a=n[0],c=n[1],s=function(){return c(e)},o=function(e){var t=e.target;c(Object(b.a)(Object(b.a)({},a),{},Object(p.a)({},t.name,t.value)))};return[a,o,s]},m="[Auth] Login",f="[Auth] Logout",O="[UI] Set Error",x="[UI] Remove Error",v="[UI] Start loading",_="[UI] Finish loading",g="[Notes] New note",y="[Notes] Set active note",w="[Notes] Load notes",N="[Notes] Updated note",k="[Notes] Delete note",E="[Notes] Logout Cleaning",C=function(e){return{type:O,payload:e}},S=function(){return{type:x}},I=n(7),A=n.n(I),P=n(13),L=n(20),D=n.n(L),U=n(30);n(158),n(74);U.a.initializeApp({apiKey:"AIzaSyCvNS6V-q1iuV2WjW3Gb1E-Ik_H--7VuNQ",authDomain:"journal-app-653df.firebaseapp.com",projectId:"journal-app-653df",storageBucket:"journal-app-653df.appspot.com",messagingSenderId:"755264379787",appId:"1:755264379787:web:6d0efc011310d0aef72d8e"});var W=U.a.firestore(),F=new U.a.auth.GoogleAuthProvider,R=function(){var e=Object(P.a)(A.a.mark((function e(t){var n,a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://api.cloudinary.com/v1_1/dithorrb8/upload",(n=new FormData).append("upload_preset","react-journal"),n.append("file",t),e.prev=4,e.next=7,fetch("https://api.cloudinary.com/v1_1/dithorrb8/upload",{method:"POST",body:n});case 7:if(!(a=e.sent).ok){e.next=13;break}return e.next=11,a.json();case 11:return r=e.sent,e.abrupt("return",r.secure_url);case 13:return e.abrupt("return",null);case 16:throw e.prev=16,e.t0=e.catch(4),e.t0;case 19:case"end":return e.stop()}}),e,null,[[4,16]])})));return function(t){return e.apply(this,arguments)}}(),B=n(31),G=function(){var e=Object(P.a)(A.a.mark((function e(t){var n,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.collection("".concat(t,"/journal/notes")).get();case 2:return n=e.sent,a=[],n.forEach((function(e){a=[].concat(Object(B.a)(a),[Object(b.a)({id:e.id},e.data())])})),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(e,t){return{type:y,payload:Object(b.a)({id:e},t)}},V=function(e,t){return{type:g,payload:Object(b.a)({id:e},t)}},q=function(e){return{type:w,payload:e}},z=function(e){return function(){var t=Object(P.a)(A.a.mark((function t(n,a){var r,c;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a().auth.uid,e.url||delete e.url,delete(c=Object(b.a)({},e)).id,t.prev=4,t.next=7,W.doc("".concat(r,"/journal/notes/").concat(e.id)).update(c);case 7:n(J(e.id,c)),null===D.a||void 0===D.a||D.a.fire("Saved",e.title,"success"),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(4),console.error(t.t0);case 14:case"end":return t.stop()}}),t,null,[[4,11]])})));return function(e,n){return t.apply(this,arguments)}}()},J=function(e,t){return{type:N,payload:Object(b.a)({id:e},t)}},X=function(e){return{type:k,payload:e}},H=function(e,t){return{type:m,payload:{uid:e,displayName:t}}},K=function(){return{type:f}},M=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.ui})),n=t.loading,r=t.msgError,c=h({email:"",password:""}),s=Object(i.a)(c,2),l=s[0],d=l.email,p=l.password,b=s[1],m=function(){return j.a.isEmail(d)?p.length<5?(e(C("Password should be at least 6 characters and match each other")),!1):(e(S()),!0):(e(C("Email is not valid")),!1)};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h3",{className:"auth__title",children:"Login"}),Object(a.jsxs)("form",{onSubmit:function(t){t.preventDefault(),m()&&e(function(e,t){return function(){var n=Object(P.a)(A.a.mark((function n(a){var r,c;return A.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a({type:v}),n.next=4,U.a.auth().signInWithEmailAndPassword(e,t);case 4:r=n.sent,c=r.user,a(H(c.uid,c.displayName)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),D.a.fire("Error",n.t0.message,"error");case 12:return n.prev=12,a({type:_}),n.finish(12);case 15:case"end":return n.stop()}}),n,null,[[0,9,12,15]])})));return function(e){return n.apply(this,arguments)}}()}(d,p))},className:"animate__animated animate__fadeIn animate__faster",children:[r&&Object(a.jsx)("div",{className:"auth__alert-error",children:r}),Object(a.jsx)("input",{type:"text",placeholder:"Email",name:"email",className:"auth__input",autoComplete:"off",value:d,onChange:b}),Object(a.jsx)("input",{type:"password",placeholder:"Password",name:"password",className:"auth__input",value:p,onChange:b}),Object(a.jsx)("button",{type:"submit",className:"btn btn-block btn-primary",disabled:n,children:"Login"}),Object(a.jsxs)("div",{className:"auth__social-networks",children:[Object(a.jsx)("p",{children:"Login with social networks"}),Object(a.jsxs)("div",{className:"google-btn",onClick:function(){return e(function(){var e=Object(P.a)(A.a.mark((function e(t){var n,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U.a.auth().signInWithPopup(F);case 3:n=e.sent,a=n.user,t(H(a.uid,a.displayName)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),D.a.fire("Error",e.t0.message,"error");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())},children:[Object(a.jsx)("div",{className:"google-icon-wrapper",children:Object(a.jsx)("img",{className:"google-icon",src:"https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg",alt:"google button"})}),Object(a.jsx)("p",{className:"btn-text",children:Object(a.jsx)("b",{children:"Sign in with google"})})]})]}),Object(a.jsx)(u.b,{to:"/auth/register",className:"link",children:"Create new account"})]})]})},Q=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.ui})).msgError,n=h({name:"",email:"",password:"",password2:""}),r=Object(i.a)(n,2),c=r[0],s=c.name,l=c.email,d=c.password,p=c.password2,b=r[1],m=function(){return s.trim().length?j.a.isEmail(l)?d!==p||d.length<5?(e(C("Password should be at least 6 characters and match each other")),!1):(e(S()),!0):(e(C("Email is not valid")),!1):(e(C("Name is required")),!1)};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h3",{className:"auth__title",children:"Register"}),Object(a.jsxs)("form",{onSubmit:function(t){t.preventDefault(),m()&&e(function(e,t,n){return function(){var a=Object(P.a)(A.a.mark((function a(r){var c,s;return A.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,U.a.auth().createUserWithEmailAndPassword(e,t);case 3:return c=a.sent,s=c.user,a.next=7,s.updateProfile({displayName:n});case 7:r(H(s.uid,s.displayName)),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(0),D.a.fire("Error",a.t0.message,"error");case 13:case"end":return a.stop()}}),a,null,[[0,10]])})));return function(e){return a.apply(this,arguments)}}()}(l,d,s))},className:"animate__animated animate__fadeIn animate__faster",children:[t&&Object(a.jsx)("div",{className:"auth__alert-error",children:t}),Object(a.jsx)("input",{type:"text",placeholder:"Name",name:"name",className:"auth__input",autoComplete:"off",value:s,onChange:b}),Object(a.jsx)("input",{type:"text",placeholder:"Email",name:"email",className:"auth__input",autoComplete:"off",value:l,onChange:b}),Object(a.jsx)("input",{type:"password",placeholder:"Password",name:"password",className:"auth__input",value:d,onChange:b}),Object(a.jsx)("input",{type:"password",placeholder:"Confirm password",name:"password2",className:"auth__input",value:p,onChange:b}),Object(a.jsx)("button",{type:"submit",className:"btn btn-block btn-primary mb-5",children:"Register"}),Object(a.jsx)(u.b,{to:"/auth/login",className:"link",children:"Already registered?"})]})]})},Y=function(){return Object(a.jsx)("div",{className:"auth__main",children:Object(a.jsx)("div",{className:"auth__box-container",children:Object(a.jsxs)(l.d,{children:[Object(a.jsx)(l.b,{path:"/auth/login",exact:!0,component:M}),Object(a.jsx)(l.b,{path:"/auth/register",exact:!0,component:Q}),Object(a.jsx)(l.a,{to:"/auth/login"})]})})})},Z=n(38),$=function(e){var t=e.isAuthenticated,n=e.component,r=Object(Z.a)(e,["isAuthenticated","component"]);return Object(a.jsx)(l.b,Object(b.a)(Object(b.a)({},r),{},{component:function(e){return t?Object(a.jsx)(n,Object(b.a)({},e)):Object(a.jsx)(l.a,{to:"/auth/login"})}}))},ee=function(e){var t=e.isAuthenticated,n=e.component,r=Object(Z.a)(e,["isAuthenticated","component"]);return Object(a.jsx)(l.b,Object(b.a)(Object(b.a)({},r),{},{component:function(e){return t?Object(a.jsx)(l.a,{to:"/"}):Object(a.jsx)(n,Object(b.a)({},e))}}))},te=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.notes})).active;return Object(a.jsxs)("div",{className:"notes__appbar",children:[Object(a.jsx)("span",{children:"23/01/2021"}),Object(a.jsx)("input",{id:"fileSelector",type:"file",name:"file",style:{display:"none"},onChange:function(t){var n=Object(i.a)(t.target.files,1)[0];n&&e(function(e){return function(){var t=Object(P.a)(A.a.mark((function t(n,a){var r,c;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a().notes.active,null===D.a||void 0===D.a||D.a.fire({title:"Uploading...",text:"Please wait...",allowOutsideClick:!1,showConfirmButton:!1,onBeforeOpen:function(){D.a.showLoading()}}),t.prev=2,t.next=5,R(e);case 5:c=t.sent,r.url=c,n(z(r)),D.a.close(),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),console.error(t.t0);case 14:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e,n){return t.apply(this,arguments)}}()}(n))}}),Object(a.jsxs)("div",{children:[Object(a.jsx)("button",{className:"btn",onClick:function(){document.querySelector("#fileSelector").click()},children:"Picture"}),Object(a.jsx)("button",{className:"btn",onClick:function(){return e(z(t))},children:"Save"})]})]})},ne=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.notes})).active,n=h(t),c=Object(i.a)(n,3),s=c[0],u=c[1],l=c[2],d=s.title,j=s.body,p=s.id,m=Object(r.useRef)(t.id);Object(r.useEffect)((function(){t.id!==m.current&&(l(t),m.current=t.id)}),[t,l]),Object(r.useEffect)((function(){e(T(s.id,Object(b.a)({},s)))}),[s,e]);return Object(a.jsxs)("div",{className:"notes__main-content animate__animated animate__fadeIn animate__faster",children:[Object(a.jsx)(te,{}),Object(a.jsxs)("div",{className:"notes__content",children:[Object(a.jsx)("input",{type:"text",placeholder:"Some awesome title",className:"notes__title-input",autoComplete:"off",name:"title",value:d,onChange:u}),Object(a.jsx)("textarea",{placeholder:"what happened today",className:"notes__textarea",name:"body",value:j,onChange:u}),t.url&&Object(a.jsx)("div",{className:"notes__images",children:Object(a.jsx)("img",{src:t.url,alt:"Imagen de google"})})]}),Object(a.jsx)("div",{className:"btn btn-danger",onClick:function(){e(function(e){return function(){var t=Object(P.a)(A.a.mark((function t(n,a){var r;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a().auth.uid,t.prev=1,t.next=4,W.doc("".concat(r,"/journal/notes/").concat(e)).delete();case 4:n(X(e)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),console.error(t.t0);case 10:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e,n){return t.apply(this,arguments)}}()}(p))},children:"Delete"})]})},ae=function(){return Object(a.jsxs)("div",{className:"nothing__main-content",children:[Object(a.jsxs)("p",{children:["Select something",Object(a.jsx)("br",{}),"or create an entry!"]}),Object(a.jsx)("i",{className:"far fa-star fa-4x mt-5"})]})},re=n(61),ce=n.n(re),se=function(e){var t=e.body,n=e.date,r=e.title,c=e.url,s=e.id,i=Object(o.b)(),u=ce()(n);return Object(a.jsxs)("div",{className:"journal__entry pointer animate__animated animate__fadeIn animate__faster",onClick:function(){return i(T(s,{title:r,body:t,url:c,date:n}))},children:[c&&Object(a.jsx)("div",{className:"journal__entry-picture",style:{backgroundSize:"cover",backgroundImage:"url(".concat(c,")")}}),Object(a.jsxs)("div",{className:"journal__entry-body",children:[Object(a.jsx)("p",{className:"journal__entry-title",children:r}),Object(a.jsx)("p",{className:"journal__entry-content",children:t})]}),Object(a.jsxs)("div",{className:"journal__entry-date-box",children:[Object(a.jsx)("span",{children:u.format("dddd")}),Object(a.jsx)("h4",{children:u.format("Do")})]})]})},oe=function(){var e=Object(o.c)((function(e){return e.notes})).notes;return Object(a.jsx)("div",{className:"journal__entries",children:e.map((function(e){return Object(a.jsx)(se,Object(b.a)({},e),e.id)}))})},ie=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.auth})).name;return Object(a.jsxs)("aside",{className:"journal__sidebar",children:[Object(a.jsxs)("div",{className:"journal__sidebar-navbar",children:[Object(a.jsxs)("h3",{className:"mt-5",children:[Object(a.jsx)("i",{className:"far fa-moon"}),Object(a.jsxs)("span",{children:[" ",t]})]}),Object(a.jsx)("button",{className:"btn mt-5",onClick:function(){return e(function(){var e=Object(P.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U.a.auth().signOut();case 3:t(K()),t({type:E}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())},children:"Logout"})]}),Object(a.jsxs)("div",{className:"journal__new-entry",onClick:function(){e(function(){var e=Object(P.a)(A.a.mark((function e(t,n){var a,r,c;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n().auth.uid,r={title:"",body:"",date:(new Date).getTime()},e.prev=2,e.next=5,W.collection("".concat(a,"/journal/notes")).add(r);case 5:c=e.sent,t(T(c.id,r)),t(V(c.id,r)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n){return e.apply(this,arguments)}}())},children:[Object(a.jsx)("i",{className:"far fa-calendar-plus fa-5x"}),Object(a.jsx)("p",{className:"mt-5",children:"New entry"})]}),Object(a.jsx)(oe,{})]})},ue=function(){var e=Object(o.c)((function(e){return e.notes})).active;return Object(a.jsxs)("div",{className:"journal__main-content animate__animated animate__fadeIn animate__faster",children:[Object(a.jsx)(ie,{}),Object(a.jsx)("main",{children:e?Object(a.jsx)(ne,{}):Object(a.jsx)(ae,{})})]})},le=function(){var e=Object(o.b)(),t=Object(r.useState)(!0),n=Object(i.a)(t,2),c=n[0],s=n[1],d=Object(r.useState)(!1),j=Object(i.a)(d,2),p=j[0],b=j[1];return Object(r.useEffect)((function(){U.a.auth().onAuthStateChanged((function(t){var n;(null===t||void 0===t?void 0:t.uid)?(e(H(t.uid,t.displayName)),b(!0),e((n=t.uid,function(){var e=Object(P.a)(A.a.mark((function e(t){var a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G(n);case 3:a=e.sent,t(q(a)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()))):b(!1),s(!1)}))}),[e,s,b]),c?Object(a.jsx)("h1",{children:"Wait..."}):Object(a.jsx)(u.a,{children:Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)(l.d,{children:[Object(a.jsx)(ee,{path:"/auth",component:Y,isAuthenticated:p}),Object(a.jsx)($,{exact:!0,path:"/",component:ue,isAuthenticated:p}),Object(a.jsx)(l.a,{to:"/auth/login"})]})})})},de=n(23),je=n(62),pe={loading:!1,msgError:null},be={notes:[],active:null},he="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||de.d,me=Object(de.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return{uid:t.payload.uid,name:t.payload.displayName};case f:return{};default:return e}},ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:return Object(b.a)(Object(b.a)({},e),{},{msgError:t.payload});case x:return Object(b.a)(Object(b.a)({},e),{},{msgError:null});case v:return Object(b.a)(Object(b.a)({},e),{},{loading:!0});case _:return Object(b.a)(Object(b.a)({},e),{},{loading:!1});default:return e}},notes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return Object(b.a)(Object(b.a)({},e),{},{notes:[t.payload].concat(Object(B.a)(e.notes))});case y:return Object(b.a)(Object(b.a)({},e),{},{active:Object(b.a)({},t.payload)});case w:return Object(b.a)(Object(b.a)({},e),{},{notes:Object(B.a)(t.payload)});case N:return Object(b.a)(Object(b.a)({},e),{},{notes:e.notes.map((function(e){return e.id===t.payload.id?t.payload:e}))});case k:return Object(b.a)(Object(b.a)({},e),{},{active:null,notes:e.notes.filter((function(e){return e.id!==t.payload}))});case E:return Object(b.a)(Object(b.a)({},e),{},{active:null,notes:[]});default:return e}}}),fe=Object(de.e)(me,he(Object(de.a)(je.a))),Oe=function(){return Object(a.jsx)(o.a,{store:fe,children:Object(a.jsx)(le,{})})};n(156);s.a.render(Object(a.jsx)(Oe,{}),document.getElementById("root"))}},[[157,1,2]]]);
//# sourceMappingURL=main.8773c268.chunk.js.map